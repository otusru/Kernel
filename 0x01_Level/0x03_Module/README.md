# üß† –ú–û–î–£–õ–¨ 3: –Ø–∑—ã–∫ C –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —è–¥—Ä–∞)

---

## üéØ –¶–µ–ª—å –º–æ–¥—É–ª—è:

* –û—Å–≤–æ–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ C, –ø—Ä–∏–º–µ–Ω–∏–º—ã–µ –≤ —Å–∏—Å—Ç–µ–º–Ω–æ–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —è–¥—Ä–∞;
* –ü–æ–Ω—è—Ç—å, –∫–∞–∫ —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–∞–º—è—Ç—å—é, —Ä–∞–±–æ—Ç–∞—Ç—å —Å —É–∫–∞–∑–∞—Ç–µ–ª—è–º–∏ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏;
* –ü–æ–ª—É—á–∏—Ç—å –≥–æ—Ç–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞, –±–ª–∏–∑–∫–∏–µ –∫ —Ç–µ–º, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —è–¥—Ä–µ Linux –∏ –º–∏–∫—Ä–æ—è–¥—Ä–∞—Ö.

---

## üîß –ü–æ—á–µ–º—É C?

–Ø–∑—ã–∫ C ‚Äî —ç—Ç–æ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π —è–∑—ã–∫ —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ –ø–∞–º—è—Ç–∏, –ø—Ä—è–º–æ–π —Ä–∞–±–æ—Ç–æ–π —Å –∞–¥—Ä–µ—Å–∞–º–∏ –∏ –±–∏—Ç–∞–º–∏, –±–µ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –∏–¥–µ–∞–ª—å–Ω—ã–º –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º.

---

## üìò –ë–∞–∑–æ–≤—ã–µ —Ç–µ–º—ã C, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å

---

### ‚úÖ 1. –†–∞–±–æ—Ç–∞ —Å —É–∫–∞–∑–∞—Ç–µ–ª—è–º–∏

–£–∫–∞–∑–∞—Ç–µ–ª–∏ ‚Äî —Å–µ—Ä–¥—Ü–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è.

```c
int x = 42;
int *ptr = &x;
printf("%d\n", *ptr);  // –í—ã–≤–µ–¥–µ—Ç: 42
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ —è–¥—Ä–µ:**

* –û–±—Ä–∞—â–µ–Ω–∏–µ –∫ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –ø–∞–º—è—Ç–∏
* –ü–µ—Ä–µ–¥–∞—á–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä –º–µ–∂–¥—É —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –±–µ–∑ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

---

### ‚úÖ 2. –†–∞–±–æ—Ç–∞ —Å –ø–∞–º—è—Ç—å—é: `malloc`, `free`, `memcpy`

–•–æ—Ç—è –≤ —è–¥—Ä–µ Linux –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–≤–æ–π –∞–ª–ª–æ–∫–∞—Ç–æ—Ä (`kmalloc`, `kfree`), –ø—Ä–∏–Ω—Ü–∏–ø —Ç–∞–∫–æ–π –∂–µ.

```c
int *arr = malloc(sizeof(int) * 10);
arr[0] = 123;
free(arr);
```

**–í —è–¥—Ä–µ:**

```c
int *arr = kmalloc(sizeof(int) * 10, GFP_KERNEL);
kfree(arr);
```

---

### ‚úÖ 3. –°—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è

```c
struct Process {
    int pid;
    char name[16];
};

struct Process p = { .pid = 1, .name = "init" };
```

**–í —è–¥—Ä–µ:**

* –í—Å–µ –æ–±—ä–µ–∫—Ç—ã ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä—ã: `task_struct`, `file`, `inode` –∏ –¥—Ä.

---

### ‚úÖ 4. –ú–∞–∫—Ä–æ—Å—ã –∏ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä

–ú–∞–∫—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–æ–≤—Å–µ–º–µ—Å—Ç–Ω–æ:

```c
#define PAGE_SIZE 4096
#define MAX(a,b) ((a) > (b) ? (a) : (b))
```

**–£—Å–ª–æ–≤–∏—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏:**

```c
#ifdef DEBUG
    printk("Debug info\n");
#endif
```

---

### ‚úÖ 5. –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏ inline-—Ñ—É–Ω–∫—Ü–∏–∏

```c
static inline int max(int a, int b) {
    return a > b ? a : b;
}
```

**–í–∞–∂–Ω–æ:** `static` –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–∞ —è–¥—Ä–∞.

---

### ‚úÖ 6. –ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –∏ –±–∏—Ç–æ–≤—ã–µ —Ñ–ª–∞–≥–∏

```c
enum ProcessState { READY, RUNNING, BLOCKED };

#define FLAG_READ   0x1
#define FLAG_WRITE  0x2
#define FLAG_EXEC   0x4
```

–§–ª–∞–≥–∏ —É–¥–æ–±–Ω–æ –æ–±—ä–µ–¥–∏–Ω—è—Ç—å:

```c
int perms = FLAG_READ | FLAG_WRITE;
if (perms & FLAG_WRITE) { ... }
```

---

### ‚úÖ 7. –í–≤–æ–¥/–≤—ã–≤–æ–¥ (–Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π)

```c
#include <unistd.h>
write(1, "Hello\n", 6);
```

–í —è–¥—Ä–µ –Ω–µ—Ç `printf`, –µ—Å—Ç—å `printk`:

```c
printk(KERN_INFO "Kernel log\n");
```

---

## üõ†Ô∏è –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `kernel_style.c` –∏ –Ω–∞–ø–∏—à–∏ –ø—Ä–∏–º–µ—Ä —è–¥—Ä–æ–ø–æ–¥–æ–±–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:

```c
#include <stdio.h>
#include <string.h>

#define TASK_NAME_LEN 16

struct task_struct {
    int pid;
    char name[TASK_NAME_LEN];
    int state;
};

void show_task(const struct task_struct *task) {
    printf("PID: %d, Name: %s, State: %d\n", task->pid, task->name, task->state);
}

int main() {
    struct task_struct init_task = { .pid = 0, .name = "init", .state = 1 };
    show_task(&init_task);
    return 0;
}
```

---

## üìò –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

* üìö **The C Programming Language (K\&R)** ‚Äî –∫–ª–∞—Å—Å–∏–∫–∞
* üß† [Learn C the Hard Way](https://learncodethehardway.org/c/)
* üß∞ [Linux Kernel C Coding Style](https://www.kernel.org/doc/html/latest/process/coding-style.html)
* üß™ [Godbolt Compiler Explorer](https://godbolt.org/) ‚Äî —Å–º–æ—Ç—Ä–∏, –∫–∞–∫ C –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ ASM

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–¥—É–ª—è:

* –¢—ã —É–≤–µ—Ä–µ–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—à—å —Å —É–∫–∞–∑–∞—Ç–µ–ª—è–º–∏, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏, –º–∞–∫—Ä–æ—Å–∞–º–∏;
* –ü–æ–Ω–∏–º–∞–µ—à—å, –∫–∞–∫ —ç—Ç–æ –ø—Ä–∏–º–µ–Ω–∏–º–æ –≤ —è–¥—Ä–µ Linux –∏ Minix;
* –ì–æ—Ç–æ–≤ –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç—Ç–∞–ø—É ‚Äî **–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —è–¥—Ä–∞ Linux** –∏ –µ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º (–º–æ–¥—É–ª—å 4).
